<!DOCTYPE html>
<html>
<head>
    <title>ä¸­è€ƒå€’è®¡æ—¶ - C2201|ä¸­è€ƒå¿…èƒœ</title>
    <meta charset="utf-8">
    <style>
        /* æ›´æ–°æ—¥å¿—ç›¸å…³æ ·å¼ */
        .action-buttons {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 10;
        }

        .action-button {
            width: auto;
            padding: 0 20px;
            height: 40px;
            border-radius: 20px;
            background: #8bc34a;
            border: none;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            color: white;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .action-button:hover {
            transform: scale(1.05);
        }

        .changelog-modal .settings-content {
            max-width: 600px;
            height: 75%;
        }

        .text-content {
            padding: 15px;
            white-space: pre-wrap;
            overflow-y: auto;
            height: calc(100% - 50px);
        }

        /* è®¾ç½®ç›¸å…³æ ·å¼ */
        .settings-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #8bc34a;
            border: none;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            transition: transform 0.3s;
        }

        .settings-button:hover {
            transform: translateX(-50%) scale(1.1);
        }

        .settings-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 999;
        }

        .settings-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .settings-content {
        background: white;
        width: 60%;
        height: 75%;
        border-radius: 12px;
        transform: scale(0.8);
        opacity: 0;
        transition: all 0.3s;
        position: relative;
        padding: 20px;
        overflow: hidden; 
    }

        .settings-modal.active .settings-content {
            transform: scale(1);
            opacity: 1;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .settings-header h3 {
            margin: 0;
            font-size: 24px;
            color: #333;
        }

        .close-btn {
            font-size: 28px;
            cursor: pointer;
            padding: 0 10px;
            color: #666;
        }

        .close-btn:hover {
            color: #333;
        }

        .settings-body {
            display: flex;
            flex-direction: column;
            gap: 30px;
            padding: 20px;
        }

        /* èŠ‚æ°”å¡ç‰‡æ ·å¼ */
        .solar-card {
            position: absolute;
            top: calc(100% + 20px);
            left: 50%;
            transform: translateX(-50%);
            width: 500px;
            background: rgba(255,255,255,0.96);
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            padding: 20px;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, transform 0.3s, visibility 0.3s;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .solar-card::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 10px solid transparent;
            border-bottom-color: rgba(255,255,255,0.96);
        }

        .solar-card.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        .solar-card h3 {
            text-align: center;
            margin: 0 0 15px;
            font-size: 24px;
            color: #1b5e20;
            font-family: STZhongsong, serif;
        }

        .solar-card img {
            width: 160px;
            height: 140px;
            object-fit: cover;
            border-radius: 8px;
        }

        .solar-card p {
            font-size: 16px;
            line-height: 1.6;
            color: #444;
            margin: 0;
            font-family: 'Microsoft YaHei';
            flex-grow: 1;
            text-align: left;
            text-indent: 2em;
        }

        /.solar-term-marker {
            transition: all 0.3s ease;
        }

        .solar-card {
            transition: opacity 0.3s, transform 0.3s, visibility 0.3s;
        }

		/* æ—¶é—´æ ·å¼ */
        .time-section {
		    font-family: 'STZh', sans-serif;
		    font-size: 44px;
		    letter-spacing: 0;
		    color: #1b5e20;
		    margin: 8px 0;
		    display: block;
   		 	width: 100%;
		}

        /* æ—¥æœŸæ ·å¼ */
        .date-section {
	        font-family: 'Microsoft YaHei', serif;
	        font-size: 22px;
	        color: #666;
	        letter-spacing: 0.5px;
	        white-space: nowrap;  /* é˜²æ­¢æ¢è¡Œ */
	        display: block;
    		width: 100%;
    	}

        /* é‡‘å¥æ ·å¼ */
        #goldenPhrase {
		    text-align: center;
		    margin: 20px auto;
		    width: 760px;
		    font-size: 24px;
		    color: #1b5e20;
		    min-height: 40px;
		    font-family: STZhongSong, cursive;
		    text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
		    transition: opacity 0.5s;
		}
 
        /* æ—¶é—´å®¹å™¨æ ·å¼ */
        #currentDateTime {
		    position: absolute;
		    top: 78px;
		    left: 25px;
		    z-index: 5;
		    background: rgba(255,255,255,0.9);
		    padding: 15px 25px;
		    border-radius: 8px;
		    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
		    text-align: center;
		    min-width: 180px;
		}
 
        /* åŸºç¡€æ ·å¼ */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(to bottom right, #f5fff5, #e8f5e9);
        }
 
        /* å¯¼èˆªæ æ ·å¼ */
        .navbar {
            background-color: #333;
            overflow: hidden;
            width: 100%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            position: relative;
            z-index: 6;
        }
 
        .brand {
            float: left;
            color: white;
            padding: 14px 20px;
            font-size: 20px;
            font-weight: bold;
            text-decoration: none;
            letter-spacing: 1px;
        }
 
        .navbar a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 18px;
            text-decoration: none;
            font-size: 16px;
            transition: all 0.3s;
        }
 
        .small-title {
            text-align: center;
            color: #2d2d2d;
            font-size: 38px;
            font-family: STZhongsong, serif;
            margin-top: 50px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
 
        .big-title {
            text-align: center;
            color: #1b5e20;
            font-size: 160px;
            font-family: STKaiti, cursive;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
 
        .timeline-container {
            max-width: 750px;
            margin: 50px auto;
            position: relative;
            height: 120px;
            overflow: visible;
        }
 
        .timeline-progress {
            height: 8px;
            background: linear-gradient(
                to right,
                #8bc34a 0%,
                #8bc34a var(--progress-percent),
                #e0e0e0 var(--progress-percent),
                #e0e0e0 100%
            );
            border-radius: 4px;
            position: relative;
            margin-top: 60px;
        }
 
        .solar-term-marker {
            position: absolute;
            top: -45px;
            width: 70px;
            text-align: center;
            transform: translateX(-50%);
            cursor: pointer;
            transition: all 0.3s;
            z-index: 2;
        }
 
        .current-marker {
            position: absolute;
            left: 0;
            top: -10px;
            width: 3px;
            height: 30px;
            background: #ff5722;
            transform: translateX(-50%);
            transition: left 0.5s ease-out;
            box-shadow: 0 2px 4px rgba(255,87,34,0.3);
        }
 
        .end-marker {
            position: absolute;
            right: -15px;
            top: -45px;
            width: 90px;
            text-align: center;
            color: #d32f2f;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(211,47,47,0.2);
            transform: translateX(30%);
        }

        /* ä½œæ¯æç¤ºæ ·å¼ */
        .schedule-container {
            position: absolute;
            top: 220px;
            left: 25px;
            z-index: 5;
            background: rgba(255,255,255,0.9);
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            min-width: 190px;
        }

        .schedule-item {
            font-family: 'STZhongSong', sans-serif;
            margin: 8px 0;
        }

        .schedule-title {
            display: block;
            font-size: 20px;
            color: #1b5e20;
            font-weight: 600;
            text-align: left;
            line-height: 1;
        }

        .schedule-value {
            display: block;
            font-size: 22px;
            color: #2d2d2d;
            text-align: center;
            margin: 4px 0 0;
            padding: 2px 0;
            line-height: 1;
        }

        .timetable {
            margin-top: 10px;
            border-top: 1px solid #eee;
            padding-top: 8px;
        }

        .timetable-item {
		    font-size: 22px;
		    font-family: STZhongSong, cursive;
		    line-height: 1.4;
            text-align: center;
		}

		.right-image-container {
            position: fixed;
            right: 25px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 5;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .right-image-container img {
	        height: 80vh;
	        object-fit: cover;
	        display: block;
	        margin: 0 auto;
	    }

        /* æ»‘å—å¼€å…³æ ·å¼ */
        input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .switch-container {
            display: flex;
            flex-direction: column;
            gap: 40px;
            margin-top: 20px;
        }

        .switch {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .slider {
            position: relative;
            cursor: pointer;
            width: 40px;
            height: 24px;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 24px;
        }

        .switch-text {
            font-size: 14px;
            color: #1b5e20;
            display: inline-block;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #8bc34a;
        }

        input:checked + .slider:before {
            transform: translateX(16px);
        }

        /* å¼€å…³é€‰ä¸­çŠ¶æ€æ–‡å­—é¢œè‰² */
        input:checked ~ .switch-text {
            color: #4CAF50;
        }

        /* æ–°å¢å…¬å‘Šå¡ç‰‡æ ·å¼ */
        .announcement-card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
            margin: 15px;
            border: 1px solid #eee;
        }

        .announcement-title {
            font-size: 1.6em;  /* å¢å¤§å­—å· */
            color: #1b5e20;
            font-weight: 600;
            margin-bottom: 8px;
            border-bottom: 2px solid #8bc34a;
            padding-bottom: 5px;
            text-align: center;  /* æ ‡é¢˜å±…ä¸­ */
        }

        .announcement-time {
            font-size: 0.95em;  /* å¢å¤§å­—å· */
            color: #666;
            margin-bottom: 15px;
            text-align: center;  /* æ—¶é—´å±…ä¸­ */
        }

        .announcement-body {
            line-height: 1.2;  /* ç¼©å°è¡Œé«˜ */
            color: #444;
            font-size: 1.2em;  /* å¢å¤§æ­£æ–‡å­—å· */
        }

        .announcement-body ul {
            margin: 8px 0;  /* ç¼©å°é—´è· */
            padding-left: 25px;
        }

        .announcement-body li {
            margin: 6px 0;  /* ç¼©å°è¡Œè· */
        }

        .announcement-footnote {
            font-size: 0.85em;
            color: #999;
            margin-top: 15px;
            border-top: 1px dashed #ddd;
            padding-top: 10px;
        }

        /* æ»šåŠ¨æ”¯æŒ */
        .announcement-content {
            height: calc(100% - 60px);  /* è‡ªåŠ¨è®¡ç®—é«˜åº¦ */
            overflow-y: auto;  /* å‚ç›´æ»šåŠ¨ */
            padding: 0 10px;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        .announcement-content::-webkit-scrollbar {
            width: 6px;
        }

        .announcement-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .announcement-content::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .announcement-content::-webkit-scrollbar-thumb:hover {
            background: #8bc34a;
        }

        .probability-control {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 100%;
            margin: 12px 0;
        }

        .probability-control .switch-text {
            flex: 1;
            font-size: 14px;
            color: #1b5e20;
        }

        .range-group {
            display: flex;
            align-items: center;
            gap: 10px;
            width: 40%; /* æ»‘åŠ¨æ¡å®¹å™¨å®½åº¦ */
            justify-content: flex-end; /* å³å¯¹é½ */
        }

        #apiProbability {
            width: 100%; /* æ»‘åŠ¨æ¡å æ»¡å®¹å™¨å®½åº¦ */
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            -webkit-appearance: none;
            margin: 0 8px;
        }

        #intervalSlider {
            width: 100%; /* æ»‘åŠ¨æ¡å æ»¡å®¹å™¨å®½åº¦ */
            height: 4px;
            background: #ddd;
            border-radius: 2px;
            -webkit-appearance: none;
            margin: 0 8px;
        }

        /* æ»‘å—æ ·å¼ */
        #apiProbability::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #8bc34a; /* ç¡®ä¿ç»¿è‰²ä¸»é¢˜è‰² */
            border-radius: 50%;
            cursor: pointer;
            border: none; /* ç§»é™¤é»˜è®¤è¾¹æ¡† */
            box-shadow: none; /* ç§»é™¤é˜´å½± */
        }

        #intervalSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: #8bc34a; /* ç¡®ä¿ç»¿è‰²ä¸»é¢˜è‰² */
            border-radius: 50%;
            cursor: pointer;
            border: none; /* ç§»é™¤é»˜è®¤è¾¹æ¡† */
            box-shadow: none; /* ç§»é™¤é˜´å½± */
        }

        #apiProbability::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #8bc34a; /* Firefoxè§¦ç‚¹é¢œè‰² */
            border-radius: 50%;
            border: none; /* é‡è¦ï¼šç§»é™¤Firefoxé»˜è®¤è¾¹æ¡† */
            cursor: pointer;
        }

        #intervalSlider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #8bc34a; /* Firefoxè§¦ç‚¹é¢œè‰² */
            border-radius: 50%;
            border: none; /* é‡è¦ï¼šç§»é™¤Firefoxé»˜è®¤è¾¹æ¡† */
            cursor: pointer;
        }

        #apiProbabilityValue {
            width: 50px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
        }

        #intervalValue {
            width: 50px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 13px;
        }

        .reset-btn {
            padding: 5px 12px;
            min-width: 50px; /* ä¿è¯æœ€å°å®½åº¦ */
            white-space: nowrap; /* ç¦æ­¢æ–‡å­—æ¢è¡Œ */
            background: #8bc34a;
            border-radius: 4px;
            color: white;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .reset-btn:hover {
            background: #7cb342;
            transform: scale(1.05);
            box-shadow: none; /* ç§»é™¤é˜´å½± */
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <header>
        <nav class="navbar">
            <div class="brand">C2201</div>
            <a href="https://c2201.github.io/">é¦–é¡µ</a>
            <a href="https://c2201.github.io/countdown/">æ–°&nbsp;Â·&nbsp;äºŒåå››èŠ‚æ°”ä¸­è€ƒå€’è®¡æ—¶</a>
            <a href="https://c2201.github.io/chicken-soup/">å¿ƒçµé¸¡æ±¤</a>
        </nav>
    </header>
 
    <!-- å®æ—¶æ—¶é’Ÿ -->
    <div id="currentDateTime">
        <div class="time-section"></div>
        <div class="date-section"></div>
    </div>

    <!-- ä½œæ¯æç¤ºå®¹å™¨ -->
    <div id="scheduleContainer" class="schedule-container">
        <div class="schedule-item">
            <span class="schedule-title">å¤©æ°”ï¼š</span>
            <span class="schedule-value" id="weatherInfo">åŠ è½½ä¸­...</span>
        </div>
        <div class="schedule-item">
            <span class="schedule-title">å½“å‰ï¼š</span>
            <span class="schedule-value" id="currentSchedule">åŠ è½½ä¸­...</span>
        </div>
        <div class="schedule-item">
            <span class="schedule-title">ä¸‹èŠ‚è¯¾ï¼š</span>
            <span class="schedule-value" id="nextSchedule">åŠ è½½ä¸­...</span>
        </div>
        <div class="timetable" id="todayTimetable"></div>
    </div>
 
    <!-- ä¸»å†…å®¹ -->
    <div class="small-title">è·ç¦»2025å¹´ä¸­è€ƒä»…å‰©</div>
    <div id="daysUntil" class="big-title"></div>
 
    <!-- æ—¶é—´è½´ -->
    <div class="timeline-container">
        <div class="timeline-progress" id="timeline">
            <div class="end-marker">
                <div style="white-space: nowrap;">ä¸­è€ƒæ—¥</div>
                <div style="font-size:0.9em; margin-top:3px">6æœˆ18æ—¥</div>
            </div>
        </div>
    </div>
 
    <!-- é‡‘å¥æ˜¾ç¤º -->
    <div id="goldenPhrase"></div>

    <!-- æ¯æ—¥60sæ˜¾ç¤º -->
    <div class="right-image-container">
        <img id="apiImage" src="" alt="æ¯æ—¥60s">
    </div>

    <!-- åº•éƒ¨æŒ‰é’®æ˜¾ç¤º -->
    <div class="action-buttons">
        <button id="settingsButton" class="action-button">âš™ï¸ è®¾ç½®</button>
        <button id="changelogButton" class="action-button">ğŸ“ æ›´æ–°æ—¥å¿—</button>
        <button id="announcementButton" class="action-button">ğŸ“¢ å…¬å‘Š</button>
    </div>

    <!-- è®¾ç½®æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>è®¾ç½®</h3>
                <span class="close-btn" id="closeSettings">&times;</span>
            </div>
            <div class="settings-body">
                <!-- ç§»åŠ¨åŸæ¥çš„å¼€å…³åˆ°è¿™é‡Œ -->
                <div class="switch-container">
                    <label class="switch">
                        <span class="switch-text">é‡‘å¥è‡ªåŠ¨è½®æ’­</span>
                        <input type="checkbox" id="goldenSwitch" checked>
                        <span class="slider"></span>
                    </label>
                    <label class="switch">
                        <span class="switch-text">æ˜¾ç¤ºæ¯æ—¥60s</span>
                        <input type="checkbox" id="imageSwitch">
                        <span class="slider"></span>
                    </label>
                    <div class="probability-control">
                        <span class="switch-text">è”ç½‘è·å–é‡‘å¥çš„æ¦‚ç‡(%)</span>
                        <div class="range-group">
                            <input type="range" id="apiProbability" min="0" max="100" value="70">
                            <input type="number" id="apiProbabilityValue" min="0" max="100" value="70">
                            <button class="reset-btn" onclick="resetProbability()">é‡ç½®</button>
                        </div>
                    </div>
                    <div class="probability-control">
                        <span class="switch-text">é‡‘å¥è½®æ’­æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰</span>
                        <div class="range-group">
                            <input type="range" id="intervalSlider" min="1" max="120" value="15">
                            <input type="number" id="intervalValue" min="1" max="120" value="15">
                            <button class="reset-btn" onclick="resetInterval()">é‡ç½®</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ›´æ–°æ—¥å¿—æ¨¡æ€æ¡† -->
    <div class="settings-modal" id="changelogModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>æ›´æ–°æ—¥å¿—</h3>
                <span class="close-btn" id="closeChangelog">&times;</span>
            </div>
            <div class="text-content" id="changelogContent"></div>
        </div>
    </div>

    <div class="settings-modal" id="announcementModal">
        <div class="settings-content">
            <div class="settings-header" style="padding-bottom: 8px;">
                <h3 style="font-size: 1.2em;">å…¬å‘Š</h3>
                <span class="close-btn" id="closeAnnouncement">&times;</span>
            </div>
            <div class="announcement-content">
                <!-- å…¬å‘Šå¡ç‰‡å®¹å™¨ -->
                <div class="announcement-card">
                    <div class="announcement-title">ğŸ“¢ å€’è®¡æ—¶ç½‘ç«™å¾ç¨¿æ´»åŠ¨å¼€å§‹å•¦ï¼</div>
                    <div class="announcement-time">2025.3.1</div>
                    <div class="announcement-body">
                        C2201å€’è®¡æ—¶ç½‘ç«™åº•éƒ¨é‡‘å¥è½®æ’­å†…å®¹å¼€å§‹å¾ç¨¿äº†ï¼
                        <ul>
                            <li><strong>å‚ä¸æ¡ä»¶ï¼š</strong>æ˜¯ä¸ªäººéƒ½èƒ½å‚åŠ </li>
                            <li><strong>æ—¶é—´ï¼š</strong>å³æ—¥èµ·è‡³æ¯•ä¸š</li>
                            <li><strong>å¾ç¨¿å†…å®¹ï¼š</strong>åŠ±å¿—æ–‡å­—ã€ä¼˜ç¾ä½œæ–‡ç´ ææˆ–æ•´æ´»ï¼ˆä¸èƒ½å…«å¦ï¼‰ç­‰ï¼ˆç‰¹åˆ«åœ°ï¼Œæ—¢å¯ä»¥åŸåˆ›ï¼Œä¹Ÿå¯ä»¥æŠ•ä½ åœ¨å…¶ä»–åœ°æ–¹çœ‹åˆ°çš„å¾ˆå¥½çš„å¥å­ä¸Šæ¥ï¼Œä½†æ˜¯è¦æ ‡æ˜å‡ºå¤„ï¼›è‹¥æ˜¯åŸåˆ›å¥å­å¯é€‰æ‹©å±•ç¤ºæ—¶æ˜¯å¦æ˜¾ç¤ºç½²åï¼‰ï¼ˆä¸€ä¸ªå¥å­å±•ç¤ºçš„æ¦‚ç‡ï¼šåŠ±å¿—æ–‡å­— = ä¼˜ç¾ä½œæ–‡ç´ æ > æ•´æ´»ï¼Œå¯æ ¹æ®å…·ä½“æƒ…å†µè°ƒæ•´ï¼Œç‰¹åˆ«åœ°ï¼Œè‹¥åŸåˆ›å¥å­å†™çš„è¿‡äºå¥½ï¼Œå¯ä»¥æé«˜å±•ç¤ºæ¦‚ç‡ï¼‰</li>
                            <li><strong>å­—æ•°è¦æ±‚ï¼š</strong>1~80å­—ï¼ˆåŒ…å«æ ‡ç‚¹ï¼‰</li>
                            <li><strong>æäº¤æ ¼å¼ï¼š</strong>ä½ çš„åå­—+å¥å­å†…å®¹+æ˜¯å¦åŸåˆ›ï¼ˆ+è‹¥éåŸåˆ›ï¼Œæ ‡æ˜å‡ºå¤„ï¼‰</li>
                            <li><strong>æäº¤æ–¹å¼ï¼š</strong>å†™åœ¨ä¾¿åˆ©è´´ä¸Šäº¤ç»™TQC</li>
                        </ul>
                        <p class="announcement-footnote">æœ€ç»ˆè§£é‡Šæƒå½’TQCæ‰€æœ‰</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
 
    <script>
        let intervalDuration = 15 * 1000; // é»˜è®¤15ç§’
        let phraseTimer = null;

        // æ»‘åŠ¨æ¡å’Œè¾“å…¥æ¡†äº‹ä»¶
        document.getElementById('intervalSlider').addEventListener('input', function(e) {
            const value = Math.min(120, Math.max(1, parseInt(e.target.value) || 15));
            intervalDuration = value * 1000;
            document.getElementById('intervalValue').value = value;
            
            // å¦‚æœè‡ªåŠ¨è½®æ’­å¼€å¯åˆ™ç«‹å³åº”ç”¨æ–°é—´éš”
            if (goldenSwitch.checked && phraseTimer) {
                clearInterval(phraseTimer);
                phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
            }
        });

        document.getElementById('intervalValue').addEventListener('input', function(e) {
            const value = Math.min(120, Math.max(1, parseInt(e.target.value) || 15));
            intervalDuration = value * 1000;
            document.getElementById('intervalSlider').value = value;
        });

        // é‡ç½®é—´éš”å‡½æ•°
        function resetInterval() {
            intervalDuration = 15 * 1000;
            document.getElementById('intervalSlider').value = 15;
            document.getElementById('intervalValue').value = 15;
            
            if (goldenSwitch.checked && phraseTimer) {
                clearInterval(phraseTimer);
                phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
            }
        }

        let apiProbability = 50; // é»˜è®¤æ¦‚ç‡å€¼

        // æ»‘åŠ¨æ¡è¾“å…¥äº‹ä»¶ç›‘å¬
        document.getElementById('apiProbability').addEventListener('input', function(e) {
            const value = Math.min(100, Math.max(0, parseInt(e.target.value) || 0));
            apiProbability = value;
            document.getElementById('apiProbabilityValue').value = value;
        });

        // æ•°å€¼è¾“å…¥æ¡†äº‹ä»¶ç›‘å¬
        document.getElementById('apiProbabilityValue').addEventListener('input', function(e) {
            const value = Math.min(100, Math.max(0, parseInt(e.target.value) || 0));
            apiProbability = value;
            document.getElementById('apiProbability').value = value;
        });

        // é‡ç½®æŒ‰é’®å‡½æ•°
        function resetProbability() {
            apiProbability = 70;
            document.getElementById('apiProbability').value = 70;
            document.getElementById('apiProbabilityValue').value = 70;
        }

        // å…¬å‘Šç›¸å…³è„šæœ¬
        const announcementButton = document.getElementById('announcementButton');
        const announcementModal = document.getElementById('announcementModal');
        const closeAnnouncement = document.getElementById('closeAnnouncement');

        // æ‰“å¼€å…¬å‘Š
        announcementButton.addEventListener('click', () => {
            announcementModal.classList.add('active');
        });

        // å…³é—­å…¬å‘Š
        closeAnnouncement.addEventListener('click', () => {
            announcementModal.classList.remove('active');
        });

        // æ›´æ–°æ—¥å¿—åŠŸèƒ½
        const changelogButton = document.getElementById('changelogButton');
        const changelogModal = document.getElementById('changelogModal');
        const closeChangelog = document.getElementById('closeChangelog');

        // æ‰“å¼€æ›´æ–°æ—¥å¿—
        changelogButton.addEventListener('click', async () => {
            try {
                const response = await fetch('update.tÂ·xt');
                if (!response.ok) throw new Error('æ–‡ä»¶åŠ è½½å¤±è´¥');
                const text = await response.text();
                
                document.getElementById('changelogContent').textContent = 
                    text || "å½“å‰æ²¡æœ‰æ›´æ–°æ—¥å¿—å†…å®¹";
                
                changelogModal.classList.add('active');
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                document.getElementById('changelogContent').textContent = 
                    "æ— æ³•åŠ è½½æ›´æ–°æ—¥å¿—ï¼Œé”™è¯¯ç 1145141919810(bushi";
                changelogModal.classList.add('active');
            }
        });

        // å…³é—­å¼¹çª—
        closeChangelog.addEventListener('click', () => {
            changelogModal.classList.remove('active');
        });

        // è®¾ç½®ç›¸å…³è„šæœ¬
        const settingsButton = document.getElementById('settingsButton');
        const settingsModal = document.getElementById('settingsModal');
        const closeButton = document.getElementById('closeSettings');

        // æ‰“å¼€è®¾ç½®
        settingsButton.addEventListener('click', () => {
            settingsModal.classList.add('active');
        });

        // å…³é—­è®¾ç½®
        closeButton.addEventListener('click', () => {
            settingsModal.classList.remove('active');
        });

    	// ä½œæ¯è¡¨æ•°æ®
        const schedule = {
            weekday: [
                ["7:00-7:30", "æ—©é¤"],
                ["7:30-7:50", "æ—©è¯»"],
                ["7:50-8:00", "è¯¾é—´"],
                ["8:00-8:40", "ç¬¬ä¸€èŠ‚è¯¾"],
                ["8:40-8:50", "è¯¾é—´"],
                ["8:50-9:30", "ç¬¬äºŒèŠ‚è¯¾"],
                ["9:30-9:35", "çœ¼ä¿å¥æ“"],
                ["9:35-9:55", "è¯¾é—´"],
                ["9:55-10:35", "ç¬¬ä¸‰èŠ‚è¯¾"],
                ["10:35-11:00", "è·‘æ“"],
                ["11:00-11:40", "ç¬¬å››èŠ‚è¯¾"],
                ["11:40-12:05", "å¬è¯»è®­ç»ƒ"],
                ["12:05-12:40", "åˆé¤"],
                ["12:40-13:40", "åˆä¼‘"],
                ["13:40-13:50", "è¯¾é—´"],
                ["13:50-14:00", "è¯¾å‰å”±"],
                ["14:00-14:40", "ç¬¬äº”èŠ‚è¯¾"],
                ["14:40-14:50", "è¯¾é—´"],
                ["14:50-15:30", "ç¬¬å…­èŠ‚è¯¾"],
                ["15:30-15:40", "è¯¾é—´"],
                ["15:40-16:20", "ç¬¬ä¸ƒèŠ‚è¯¾"],
                ["16:20-16:25", "çœ¼ä¿å¥æ“"],
                ["16:25-16:35", "è¯¾é—´"],
                ["16:35-17:15", "ç¬¬å…«èŠ‚è¯¾"],
                ["17:15-17:20", "è¯¾é—´"],
                ["17:20-18:00", "ç¬¬ä¹èŠ‚è¯¾"],
                ["18:00-18:40", "æ™šé¤"],
                ["18:40-20:00", "ç¬¬ä¸€èŠ‚æ™šè‡ªä¹ "],
                ["20:00-20:10", "è¯¾é—´"],
                ["20:10-21:30", "ç¬¬äºŒèŠ‚æ™šè‡ªä¹ "],
                ["21:30-21:40", "è¯¾é—´"],
                ["21:40-22:50", "ç¬¬ä¸‰èŠ‚æ™šè‡ªä¹ "],
                ["22:50-7:00", "ç¡è§‰"]
            ]
        };

        // è¯¾ç¨‹è¡¨æ•°æ®
        const timetable = {
            monday: ["æ•°å­¦","è‹±è¯­","æ”¿æ²»","ç‰©ç†","è¯­æ–‡","è¯­æ–‡","åŒ–å­¦","ä½“è‚²","æ•°å­¦"],
            tuesday: ["è‹±è¯­","æ•°å­¦","æ•°å­¦","è¯­æ–‡","ä½“è‚²","å†å²","æ”¿æ²»","è¯­æ–‡","å†å²"],
            wednesday: ["æ•°å­¦","ç‰©ç†","è‹±è¯­","å†å²","éŸ³/ç¾","åŒ–å­¦","è¯­æ–‡","åŒ–å­¦","ç‰©ç†"],
            thursday: ["è¯­æ–‡","ç‰©ç†","åŒ–å­¦","æ•°å­¦","è‹±è¯­","æ”¿æ²»","å†å²","è‹±è¯­","æ”¿æ²»"],
            friday: ["æ•°å­¦","è¯­æ–‡","è‹±è¯­","ä½“è‚²","ç‰©ç†","åŒ–å­¦","ç­ä¼š","æ–‡ä½“æ´»åŠ¨","æ–‡ä½“æ´»åŠ¨"]
        };

        // æ—¶é—´è½¬æ¢å‡½æ•°
		function timeToMinutes(time) {
		    const [h, m] = time.split(':').map(Number);
		    return h * 60 + m;
		}

        // è·å–å½“å‰ä½œæ¯å‡½æ•°
		function getCurrentSchedule() {
		    const now = new Date();
		    const day = now.getDay();
		    const currentMinutes = now.getHours() * 60 + now.getMinutes();

		    if(day === 0 || day === 6) return {current: "å‘¨æœ«", nextLesson: ""};

		    const todaySchedule = schedule.weekday;
		    let current = "";
		    let nextLesson = "";

		    // å¤„ç†è·¨å¤©æ—¶æ®µï¼ˆ22:50-7:00ï¼‰
		    if(currentMinutes >= timeToMinutes("22:50") || currentMinutes < timeToMinutes("7:00")) {
		        current = "ç¡è§‰";
		        // æŸ¥æ‰¾æ˜å¤©ç¬¬ä¸€ä¸ª"èŠ‚è¯¾"
		        const firstLesson = todaySchedule.find(item => item[1].endsWith("èŠ‚è¯¾"));
		        nextLesson = firstLesson ? firstLesson[1] : "";
		        return {current, nextLesson};
		    }

		    let currentIndex = -1;
		    
		    // æŸ¥æ‰¾å½“å‰æ—¶é—´æ®µ
		    for(let i = 0; i < todaySchedule.length; i++) {
		        const [start, end] = todaySchedule[i][0].split('-');
		        const startTime = timeToMinutes(start);
		        const endTime = timeToMinutes(end);

		        if(currentMinutes >= startTime && currentMinutes < endTime) {
		            current = todaySchedule[i][1];
		            currentIndex = i;
		            break;
		        }
		    }

		    // æŸ¥æ‰¾ä¸‹ä¸€ä¸ª"èŠ‚è¯¾"
		    if(currentIndex >= 0) {
		        for(let i = currentIndex + 1; i < todaySchedule.length; i++) {
		            if(todaySchedule[i][1].endsWith("èŠ‚è¯¾")) {
		                nextLesson = todaySchedule[i][1];
		                break;
		            }
		        }
		    }

		    return {current, nextLesson};
		}

        // è·å–è¯¾ç¨‹åç§°
        function getCourseName(day, lessonIndex) {
            const days = ["sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday"];
            const timetableDay = timetable[days[day]];
            return timetableDay ? timetableDay[lessonIndex] : "";
        }

        // æ›´æ–°ä½œæ¯æ˜¾ç¤º
		function updateScheduleDisplay() {
            const now = new Date();
            const day = now.getDay();  
            const {current, nextLesson} = getCurrentSchedule();

            // å½“å‰ä½œæ¯
            let currentText = current;
            if(current.includes(" è¯¾")) {
                // æ‰¾åˆ°å½“å‰èŠ‚è¯¾åœ¨è¯¾ç¨‹è¡¨ä¸­çš„ä½ç½®
                const lessonItems = schedule.weekday.filter(item   => item[1].includes("èŠ‚"));
                const currentLessonIndex = lessonItems.findIndex(item   => item[1] === current);
                if(currentLessonIndex >=0 && currentLessonIndex <9) {
                    currentText = getCourseName(day, currentLessonIndex);
                }
            }
            document.getElementById('currentSchedule').textContent   = currentText;

            // ä¸‹èŠ‚è¯¾
            let nextText = nextLesson;
            if(nextLesson) {
                const lessonItems = schedule.weekday.filter(item   => item[1].includes("èŠ‚"));
                const nextLessonIndex = lessonItems.findIndex(item   => item[1] === nextLesson);
                if(nextLessonIndex >=0 && nextLessonIndex <9) {
                    nextText = getCourseName(day, nextLessonIndex);
                }
            }
            document.getElementById('nextSchedule').textContent   = nextText || "æ— ";

		    // ä»Šæ—¥è¯¾è¡¨
		    if(day >=1 && day <=5) {
		        const courses = timetable[Object.keys(timetable)[day-1]];
		        document.getElementById('todayTimetable').innerHTML   = courses.map((c,i)   => 
		            `<div class="timetable-item">${i+1}&nbsp;${c}</div>`
		        ).join('');
		    } else {
		        document.getElementById('todayTimetable').innerHTML   = 
		            '<div class="timetable-item">å‘¨æœ«æ— è¯¾è¡¨</div>';
		    }
		}

        // èŠ‚æ°”æ•°æ®ï¼ˆéƒ¨åˆ†ï¼‰ï¼ˆ2025å¹´ï¼‰
        const solarTerms = [
        { 
            name: 'ç«‹æ˜¥', 
            month: 1, 
            day: 3, 
            color: '#a5d6a7',
            image: 'images/ç«‹æ˜¥.png',
            desc: 'ç«‹æ˜¥æ˜¯äºŒåå››èŠ‚æ°”ä¹‹é¦–ï¼Œæ ‡å¿—ç€å†¬å¤©çš„ç»“æŸå’Œæ˜¥å¤©çš„å¼€å§‹ã€‚æ­¤æ—¶æ°”æ¸©å¼€å§‹å›æš–ï¼Œä¸‡ç‰©å¤è‹ï¼Œä¸œé£é€æš–ï¼ŒæŸ³æ ‘å‘èŠ½ï¼Œæ¢…èŠ±ç»½æ”¾ã€‚å¤ä»£æœ‰è¿æ˜¥ä»ªå¼å’Œå’¬æ˜¥ä¹ ä¿—ï¼Œäººä»¬ç¥ˆæ±‚æ–°å¹´å‰ç¥¥å¦‚æ„ã€‚'
        },
        { 
            name: 'é›¨æ°´', 
            month: 1, 
            day: 18, 
            color: '#8bc34a',
            image: 'images/é›¨æ°´.png',
            desc: 'é›¨æ°´èŠ‚æ°”æ­£å€¼ä»²æ˜¥ä¹‹åˆï¼Œæ°”æ¸©ç»§ç»­å›å‡ï¼Œé™æ°´å¢å¤šï¼Œå†°é›ªèåŒ–ã€‚è¿™ä¸ªæ—¶èŠ‚é€‚å®œæ˜¥è€•å¤‡è€•ï¼Œå†œæ°‘å¼€å§‹å¿™ç¢Œå†œäº‹ã€‚å¤äººæœ‰"ç­ç¥­é±¼"ã€"é¸¿é›æ¥"ç­‰ç‰©å€™ç°è±¡è§‚å¯Ÿè®°è½½ã€‚'
        },
        { 
            name: 'æƒŠè›°', 
            month: 2, 
            day: 5, 
            color: '#7cb342',
            image: 'images/æƒŠè›°.png',
            desc: 'æƒŠè›°æ—¶èŠ‚æ˜¥é›·å§‹é¸£ï¼Œè›°ä¼çš„æ˜†è™«è¢«æƒŠé†’è€Œå‡ºã€‚æ­¤æ—¶æ¡ƒèŠ±ç››å¼€ï¼ŒæèŠ±æ€’æ”¾ï¼Œç”°é—´åœ°å¤´ä¸€ç‰‡ç¹å¿™æ™¯è±¡ã€‚å¤æœ‰"æ¡ƒå§‹å"ã€"ä»“åºšé¸£"çš„ç‰©å€™ç‰¹å¾ã€‚'
        },
        { 
            name: 'æ˜¥åˆ†', 
            month: 2, 
            day: 20, 
            color: '#69a63d',
            image: 'images/æ˜¥åˆ†.png',
            desc: 'æ˜¥åˆ†æ—¥æ˜¼å¤œå¹³åˆ†ï¼Œæ ‡å¿—ç€æ˜¥å­£ä¸­æœŸã€‚æ­¤æ—¶èºé£è‰é•¿ï¼Œå°éº¦æ‹”èŠ‚å­•ç©—ï¼Œå†œäº‹æ´»åŠ¨è¿›å…¥ç¹å¿™é˜¶æ®µã€‚æ°‘é—´æœ‰ç«–è›‹æ¸¸æˆå’Œç¥­æ—¥ä¹ ä¿—ã€‚'
        },
        { 
            name: 'æ¸…æ˜', 
            month: 3, 
            day: 4, 
            color: '#5d9536',
            image: 'images/æ¸…æ˜.png',
            desc: 'æ¸…æ˜æ—¶èŠ‚æ°”æ¸©å‡é«˜ï¼Œæ˜¥é›¨ç»µç»µæ»‹æ¶¦å¤§åœ°ã€‚è¿™æ˜¯æ‰«å¢“ç¥­ç¥–çš„é‡è¦æ—¥å­ï¼Œä¹Ÿæ˜¯è¸é’èµèŠ±çš„å¥½æ—¶æœºã€‚å¤ä»£æœ‰è¹´é ã€è¡ç§‹åƒç­‰å¨±ä¹æ´»åŠ¨ã€‚'
        },
        { 
            name: 'è°·é›¨', 
            month: 3, 
            day: 20, 
            color: '#4d802e',
            image: 'images/è°·é›¨.png',
            desc: 'è°·é›¨æ˜¯æ˜¥å­£æœ€åä¸€ä¸ªèŠ‚æ°”ï¼Œé™é›¨é‡å¢åŠ åˆ©äºè°·ç‰©ç”Ÿé•¿ã€‚æ­¤æ—¶ç‰¡ä¸¹ç››å¼€ï¼ŒèŒ¶æ ‘æŠ½æ–°èŠ½ï¼Œå†œå¿™å­£èŠ‚å…¨é¢åˆ°æ¥ã€‚æœ‰"èå§‹ç”Ÿ"ã€"é¸£é¸ æ‹‚å…¶ç¾½"ç­‰ç‰©å€™ç°è±¡ã€‚'
        },
        { 
            name: 'ç«‹å¤', 
            month: 4, 
            day: 5, 
            color: '#467930',
            image: 'images/ç«‹å¤.png',
            desc: 'ç«‹å¤æ ‡å¿—ç€å¤å­£çš„å¼€å§‹ï¼Œæ°”æ¸©æ˜¾è‘—ä¸Šå‡ã€‚æ­¤æ—¶è¼èˆé¸£å«ï¼Œèš¯èš“å‡ºåœ°é¢ï¼Œç‹ç“œå¼€å§‹ç”Ÿé•¿ã€‚å¤ä»£æœ‰"è¿å¤"ä»ªå¼å’Œå°æ–°æ´»åŠ¨ã€‚'
        },
        { 
            name: 'å°æ»¡', 
            month: 4, 
            day: 21, 
            color: '#3d6826',
            image: 'images/å°æ»¡.png',
            desc: 'å°æ»¡æ—¶èŠ‚éº¦ç±»ä½œç‰©ç±½ç²’å¼€å§‹é¥±æ»¡ä½†æœªæˆç†Ÿã€‚æ­¤æ—¶èš•ç»“èŒ§ï¼Œèœå­æˆç†Ÿå¯ä»¥æ”¶å‰²ã€‚å†œè°šæœ‰"å°æ»¡å°æ»¡ï¼Œéº¦ç²’æ¸æ»¡"çš„è¯´æ³•ã€‚'
        },
        { 
            name: 'èŠ’ç§', 
            month: 5, 
            day: 5, 
            color: '#30571f',
            image: 'images/èŠ’ç§.png',
            desc: 'èŠ’ç§æ˜¯å†œå¿™æ—¶èŠ‚ï¼ŒåŒ—æ–¹éº¦æ”¶å—æ–¹æ’ç§§ã€‚æ­¤æ—¶æ¢…å­æˆç†Ÿï¼Œå¤©æ°”æ½®æ¹¿é—·çƒ­ã€‚å†œè°šè¯´"èŠ’ç§å¿™å¿™ç§"ï¼ŒæŠ“ç´§æ—¶é—´æ’­ç§ä½œç‰©ã€‚'
        },
        { 
            name: 'å¤è‡³', 
            month: 5, 
            day: 21, 
            color: '#254517',
            image: 'å¤è‡³.png',
            desc: 'å¤è‡³æ—¥åŒ—åŠçƒç™½æ˜¼æœ€é•¿ï¼Œæ ‡å¿—ç€ç››å¤åˆ°æ¥ã€‚æ­¤æ—¶è‰é¸£é˜µé˜µï¼Œè·èŠ±ç››å¼€ï¼Œå†œä½œç‰©ç”Ÿé•¿æ—ºç››ã€‚å¤äººæœ‰ç¥­å¤©ä»ªå¼å’Œæ¶ˆå¤æ´»åŠ¨ã€‚'
        },
        { 
            name: 'å°æš‘', 
            month: 6, 
            day: 7, 
            color: '#1c3611',
            image: 'å°æš‘.png',
            desc: 'å°æš‘æ—¶èŠ‚å¤©æ°”é€æ¸ç‚çƒ­ï¼Œé›·é›¨å¢å¤šã€‚æ­¤æ—¶èŸ‹èŸ€å¼€å§‹åœ¨å¢™è§’é¸£å«ï¼Œé¹°éš¼æ•é£Ÿæ›´åŠ é¢‘ç¹ã€‚å†œè°šæœ‰"å°æš‘å¤§æš‘ï¼ŒçŒæ­»è€é¼ "çš„è¯´æ³•ã€‚'
        },
        { 
            name: 'å¤§æš‘', 
            month: 6, 
            day: 22, 
            color: '#122408',
            image: 'å¤§æš‘.png',
            desc: 'å¤§æš‘æ˜¯ä¸€å¹´ä¸­æœ€çƒ­çš„æ—¶èŠ‚ï¼Œé«˜æ¸©é…·æš‘è€ƒéªŒç€ä¸‡ç‰©ç”Ÿé•¿ã€‚æ­¤æ—¶è·èŠ±ç››å¼€è‡³æï¼Œé›·é˜µé›¨é¢‘ç¹å‡ºç°ã€‚å¤äººæœ‰é¥®ä¼èŒ¶ã€æ™’ä¼å§œçš„ä¹ ä¿—ã€‚'
        },
        { 
            name: 'ç«‹ç§‹', 
            month: 7, 
            day: 7, 
            color: '#1a3a4a',
            image: 'ç«‹ç§‹.png',
            desc: 'ç«‹ç§‹æ ‡å¿—ç€ç§‹å¤©çš„å¼€å§‹ï¼Œæ°”æ¸©ç”±çƒ­è½¬å‡‰ã€‚æ­¤æ—¶æ—©æ™šæ¸©å·®åŠ å¤§ï¼Œç¨»è°·æŠ½ç©—æ‰¬èŠ±ã€‚å¤äººæœ‰"è´´ç§‹è†˜"ã€"å•ƒç§‹"ç­‰ä¹ ä¿—ã€‚'
        },
        { 
            name: 'å¤„æš‘', 
            month: 7, 
            day: 23, 
            color: '#2d4d5d',
            image: 'å¤„æš‘.png',
            desc: 'å¤„æš‘æ—¶èŠ‚æš‘æ°”æ¶ˆé€€ï¼Œç§‹æ„æ¸æµ“ã€‚æ­¤æ—¶å†œä½œç‰©è¿›å…¥æˆç†ŸæœŸï¼Œå†œæ°‘å¼€å§‹æ”¶å‰²ã€‚å¤ä»£æœ‰"ç¥­èœ¡"å’Œ"è¿ç§‹"ä»ªå¼ã€‚'
        },
        { 
            name: 'ç™½éœ²', 
            month: 8, 
            day: 7, 
            color: '#3d5d6d',
            image: 'ç™½éœ².png',
            desc: 'ç™½éœ²æ—¶èŠ‚å¤©æ°”è½¬å‡‰ï¼Œæ¸…æ™¨éœ²æ°´å‡ç»“æˆéœœã€‚æ­¤æ—¶é¸¿é›å—é£ï¼ŒèŠèŠ±å¼€æ”¾ã€‚å†œè°šæœ‰"ç™½éœ²ç™½èŒ«èŒ«ï¼Œæ— è°·æ»¡ç²®ä»“"çš„è¯´æ³•ã€‚'
        },
        { 
            name: 'ç§‹åˆ†', 
            month: 8, 
            day: 23, 
            color: '#4d6d7d',
            image: 'ç§‹åˆ†.png',
            desc: 'ç§‹åˆ†æ—¥æ˜¼å¤œå¹³åˆ†ï¼Œæ ‡å¿—ç€ç§‹å­£ä¸­æœŸã€‚æ­¤æ—¶ç§‹é«˜æ°”çˆ½ï¼Œæ¡‚èŠ±é£˜é¦™ã€‚å¤ä»£æœ‰"ç«–è›‹"å’Œ"é€ç§‹ç‰›"çš„ä¹ ä¿—ã€‚'
        },
        { 
            name: 'å¯’éœ²', 
            month: 9, 
            day: 8, 
            color: '#5d7d8d',
            image: 'å¯’éœ².png',
            desc: 'å¯’éœ²æ—¶èŠ‚æ°”æ¸©é™ä½ï¼Œéœ²æ°´å¯’å†·å‡ç»“ã€‚æ­¤æ—¶èŠèŠ±ç››å¼€è‡³æï¼Œå†œäº‹è¿›å…¥æŠ¢æ”¶é˜¶æ®µã€‚å¤äººæœ‰èµèŠå’Œé¥®èŠèŠ±é…’çš„ä¹ ä¿—ã€‚'
        },
        { 
            name: 'éœœé™', 
            month: 9, 
            day: 23, 
            color: '#6d8da7',
            image: 'éœœé™.png',
            desc: 'éœœé™æ˜¯ç§‹å­£æœ€åä¸€ä¸ªèŠ‚æ°”ï¼Œå¤©æ°”æ¸å†·åˆéœœå‡ºç°ã€‚æ­¤æ—¶æŸ¿å­æˆç†Ÿçº¢é€ï¼Œæ«å¶å˜çº¢ã€‚å†œè°šæœ‰"éœœé™è§éœœï¼Œç±³è°·æ»¡ä»“"çš„è¯´æ³•ã€‚'
        },
        { 
            name: 'ç«‹å†¬', 
            month: 10, 
            day: 7, 
            color: '#7d9dc3',
            image: 'ç«‹å†¬.png',
            desc: 'ç«‹å†¬æ ‡å¿—ç€å†¬å­£çš„å¼€å§‹ï¼Œæ°”æ¸©æ˜æ˜¾ä¸‹é™ã€‚æ­¤æ—¶æ°´å§‹å†°åœ°å§‹å†»ï¼Œå†œæ°‘å¼€å§‹å‡†å¤‡è¶Šå†¬ä½œç‰©ã€‚å¤ä»£æœ‰"è´ºå†¬"å’Œ"è¡¥å†¬"çš„ä¹ ä¿—ã€‚'
        },
        { 
            name: 'å°é›ª', 
            month: 10, 
            day: 22, 
            color: '#8da6d9',
            image: 'å°é›ª.png',
            desc: 'å°é›ªæ—¶èŠ‚å¤©æ°”å¯’å†·é™é›ªå¼€å§‹ã€‚æ­¤æ—¶é˜´æ°”ä¸‹é™é˜³æ°”ä¸Šå‡ï¼Œå†œäº‹è¿›å…¥å†¬é—²æ—¶æœŸã€‚å¤äººæœ‰è…Œåˆ¶è…Šè‚‰å’Œè§‚èµé›ªæ™¯çš„ä¹ ä¿—ã€‚'
        },
        { 
            name: 'å¤§é›ª', 
            month: 11, 
            day: 7, 
            color: '#9fb4e6',
            image: 'å¤§é›ª.png',
            desc: 'å¤§é›ªæ—¶èŠ‚é™é›ªé‡å¢åŠ å¤©æ°”æ›´åŠ å¯’å†·ã€‚æ­¤æ—¶é¹–é¸Ÿä¸é¸£è™å§‹äº¤ï¼Œå†œäº‹åŸºæœ¬ç»“æŸè¿›å…¥å†œé—²ã€‚å¤äººæœ‰èµé›ªå’Œåˆ¶ä½œè…Šè‚‰çš„ä¹ ä¿—ã€‚'
        },
        { 
            name: 'å†¬è‡³', 
            month: 11, 
            day: 21, 
            color: '#b3c2ec',
            image: 'å†¬è‡³.png',
            desc: 'å†¬è‡³æ—¥åŒ—åŠçƒç™½æ˜¼æœ€çŸ­æ ‡å¿—ç€å¯’å†¬åˆ°æ¥ã€‚æ­¤æ—¶èš¯èš“ç»“éº‹è§’è§£æ°´æ³‰åŠ¨ï¼Œå¤ä»£æœ‰"å†¬è‡³å¤§å¦‚å¹´"çš„è¯´æ³•å’Œç¥­ç¥€æ´»åŠ¨ã€‚'
        },
        { 
            name: 'å°å¯’', 
            month: 12, 
            day: 6, 
            color: '#c5d1f0',
            image: 'å°å¯’.png',
            desc: 'å°å¯’æ—¶èŠ‚å¤©æ°”å¯’å†·ä½†æœªè¾¾æç‚¹ã€‚æ­¤æ—¶é›åŒ—ä¹¡é¹Šå§‹å·¢é›‰é›Šé¸²ï¼Œå†œäº‹åŸºæœ¬åœæ­¢è¿›å…¥å†œé—²ã€‚å¤äººæœ‰"æ•°ä¹æ¶ˆå¯’"çš„ä¹ ä¿—ã€‚'
        },
        { 
            name: 'å¤§å¯’', 
            month: 12, 
            day: 20, 
            color: '#d9e0ff',
            image: 'å¤§å¯’.png',
            desc: 'å¤§å¯’æ˜¯ä¸€å¹´ä¸­æœ€å†·æ—¶èŠ‚æ ‡å¿—ç€å†¬å­£å°¾å£°ã€‚æ­¤æ—¶é¸¡ä¹³æ³½è…¹æ°´æ³‰åŠ¨ï¼Œå†œäº‹å…¨éƒ¨ç»“æŸå‡†å¤‡è¿‡å¹´ã€‚å¤äººæœ‰"é™¤æ—§å¸ƒæ–°"çš„ä¹ ä¿—è¿æ¥æ–°æ˜¥åˆ°æ¥ã€‚'
        }
    ];
 
        // é‡‘å¥åŠŸèƒ½é…ç½® 
        const GOLDEN_APIs = [
		    'https://img.8845.top/yiyan/index.php', 
		    'https://api.mu-jie.cc/stray-birds/range?type=json', 
		    'https://v.api.aa1.cn/api/api-wenan-mingrenmingyan/index.php?aa1=json' 
		];
		let currentApiIndex = 0;
        const localPhrases = {
            high: [ // 60% æ¦‚ç‡
                "åœ¨æ™¨æ›¦çš„å¾®å…‰ä¸­ï¼Œéœ²ç è½»å»ç€èŠ±ç“£ï¼Œå¦‚åŒç¹æ˜Ÿç‚¹ç¼€äºå¤œç©ºçš„è¾¹é™…ã€‚",
                "å¤•é˜³å¦‚ç†”é‡‘æ´’è½ï¼Œå°†å¤©è¾¹æŸ“æˆä¸€å¹…ç»šçƒ‚çš„ç”»å·ï¼Œé™å€™é‚£æ°¸ä¸è¤ªè‰²çš„é»„æ˜ã€‚",
                "æ˜Ÿå…‰åœ¨å¤œçš„ç»‡é”¦ä¸Šç»†ç»†æç»˜ï¼Œæ¯ä¸€é¢—éƒ½æ˜¯æœªå®Œçš„æ•…äº‹ï¼Œæ‚¬äºæ— å çš„å®‡å®™ä¹‹ä¸­ã€‚",
                "é£ï¼Œç©¿è¶Šå¤è€çš„å··å¼„ï¼Œæºå¸¦ç€æ—¶å…‰çš„ä½è¯­ï¼Œè½»æŠšè¿‡å²æœˆçš„ç—•è¿¹ã€‚",
                "æœˆå…‰å€¾æ´’ï¼Œå¦‚ç»†ä¸èˆ¬ç¼ ç»•ç€æ ‘æ¢¢ï¼Œç¼–ç»‡ç€å¤œçš„é™è°§ä¸æ¸©æŸ”ã€‚",
                "æ™¨æ›¦åˆç ´ï¼Œéœå…‰å¦‚ç»‡ï¼Œå¤©è¾¹æ¸æ¸æ³›èµ·å¸Œæœ›çš„è‰²å½©ï¼Œè¿æ¥æ–°æ—¥çš„è¯ç”Ÿã€‚",
                "è½å¶åœ¨ç§‹é£ä¸­èµ·èˆï¼Œæ¯ä¸€ç‰‡éƒ½æ˜¯å­£èŠ‚çš„ç¬”è§¦ï¼Œä¹¦å†™ç€å²æœˆçš„è¯—ç¯‡ã€‚",
                "é›¾æ°”ç¼­ç»•åœ¨å±±é—´ï¼Œä»¿ä½›æ˜¯å¤§è‡ªç„¶çš„å‘¼å¸ï¼Œè½»æŸ”åœ°è¦†ç›–ç€ä¸‡ç‰©çš„æ¢¦å¢ƒã€‚",
                "é›¨æ»´è½»æ•²çª—æ£‚ï¼Œå¦‚åŒå¤©ç©ºåœ¨ä½è¯­ï¼Œè¯‰è¯´ç€æœªäº†çš„æƒ…ç¼˜ã€‚",
                "åœ¨é‚£é¥è¿œçš„å¤©é™…ï¼Œäº‘å½©ç¼–ç»‡ç€é­”æ³•çš„åŸå ¡ï¼Œç­‰å¾…ç€å‹‡æ•¢çš„æ¢é™©è€…å»æ¢å¯»ã€‚"
            ],
            medium: [ // 30% æ¦‚ç‡
                "å®å‰‘é”‹ä»ç£¨ç ºå‡ºï¼Œæ¢…èŠ±é¦™è‡ªè‹¦å¯’æ¥ã€‚â€”â€”ã€Šè­¦ä¸–è´¤æ–‡Â·å‹¤å¥‹ç¯‡ã€‹",
                "åƒæ·˜ä¸‡æ¼‰è™½è¾›è‹¦ï¼Œå¹å°½ç‹‚æ²™å§‹åˆ°é‡‘ã€‚â€”â€”åˆ˜ç¦¹é”¡ã€Šæµªæ·˜æ²™Â·è«é“è°—è¨€å¦‚æµªæ·±ã€‹",
                "é’æ˜¥é¡»æ—©ä¸ºï¼Œå²‚èƒ½é•¿å°‘å¹´ã€‚â€”â€”å­ŸéƒŠã€ŠåŠå­¦ã€‹"
            ],
            low: [ // 10% æ¦‚ç‡
                "å†·çŸ¥è¯†ï¼šä¸€åŠ ä¸€å…¶å®ç­‰äºäºŒã€‚"
            ]
        };
 
        // ç”ŸæˆèŠ‚æ°”æ ‡è®° 
        function generateSolarMarkers() {
            const springStart = solarTerms.find(t  => t.name  === 'ç«‹æ˜¥');
            const startDate = new Date(2025, springStart.month,  springStart.day); 
            const endDate = new Date(2025, 5, 18);
            const totalDays = (endDate - startDate) / 86400000;
 
            document.querySelectorAll('.solar-term-marker').forEach(m  => m.remove()); 
 
            solarTerms.forEach(term  => {
                const termDate = new Date(2025, term.month,  term.day); 
                if (termDate < startDate || termDate > endDate) return;
 
                const position = ((termDate - startDate) / 86400000 / totalDays) * 100;
                const isPast = termDate < new Date();
 
                const marker = document.createElement('div'); 
                marker.className  = 'solar-term-marker';
                marker.style.left  = `${position}%`;
                marker.innerHTML  = `
                    <div style="color: ${isPast ? '#666' : term.color}; 
                        font-weight: ${isPast ? 'normal' : '600'};
                        text-shadow: ${isPast ? 'none' : '0 2px 4px rgba(0,0,0,0.1)'}">
                        ${term.name} 
                    </div>
                    <div style="font-size:0.9em; color: ${isPast ? '#999' : '#666'};
                        margin-top: 5px">
                        ${termDate.getMonth()+1}  æœˆ${termDate.getDate()}  æ—¥ 
                    </div>
                `;
 
                marker.addEventListener('mouseover',  () => {
                    if (!isPast) {
                        marker.style.transform  = 'translateX(-50%) scale(1.1)';
                        // marker.style.filter  = 'drop-shadow(0 4px 6px rgba(0,0,0,0.15))';
                    }
                });
                marker.addEventListener('mouseout',  () => {
                    marker.style.transform  = 'translateX(-50%) scale(1)';
                    marker.style.filter  = 'none';
                });
 
                timeline.appendChild(marker); 

                // åˆ›å»ºå¡ç‰‡
                const card = document.createElement('div');
                card.className = 'solar-card';
                card.innerHTML = `
                    <h3>${term.name}</h3>
                    <img src="${term.image}" alt="${term.name}">
                    <p>${term.desc}</p>
                `;
                marker.appendChild(card);

                // ç‚¹å‡»äº‹ä»¶å¤„ç†
                marker.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const allCards = document.querySelectorAll('.solar-card');
                    allCards.forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                });
            });

            // ç‚¹å‡»å…¶ä»–åŒºåŸŸéšè—å¡ç‰‡
            document.addEventListener('click', () => {
                document.querySelectorAll('.solar-card').forEach(c => c.classList.remove('active'));
            });
        }
 
        // æ—¶é—´è½´è¿›åº¦ 
        function updateTimelineColor() {
            const springStart = solarTerms.find(t  => t.name  === 'ç«‹æ˜¥');
            const startDate = new Date(2025, springStart.month,  springStart.day); 
            const endDate = new Date(2025, 5, 18);
            const now = new Date();
 
            const total = endDate - startDate;
            const progress = Math.min(1,  Math.max(0,  (now - startDate) / total));
 
            timeline.style.setProperty('--progress-percent',  `${progress * 100}%`);
            requestAnimationFrame(updateTimelineColor);
        }
 
        // å€’è®¡æ—¶æ›´æ–° 
        function updateCountdown() {
            const target = new Date(2025, 5, 18);
            const diff = target - new Date();
            const days = Math.max(0,  Math.ceil(diff  / 86400000));
            document.getElementById('daysUntil').textContent  = `${days}å¤©`;
 
            const now = new Date();
            const msToNextDay = 86400000 - (now % 86400000);
            setTimeout(updateCountdown, msToNextDay);
        }
 
        // æ›´æ–°æ—¶é—´æ˜¾ç¤ºå‡½æ•° 
        function updateClock() {
            const date = new Date();
            const weekDays = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'];
            
            // æ—¶é—´éƒ¨åˆ† 
            const hh = date.getHours().toString().padStart(2,  '0');
            const mm = date.getMinutes().toString().padStart(2,  '0');
            const ss = date.getSeconds().toString().padStart(2,  '0');
            
            // æ—¥æœŸéƒ¨åˆ† 
            const yyyy = date.getFullYear(); 
            const m = (date.getMonth()  + 1).toString().padStart(2, '0');
            const d = date.getDate().toString().padStart(2,  '0');
            const week = weekDays[date.getDay()];
 
            document.getElementById('currentDateTime').innerHTML  = `
                <div class="time-section">${hh}:${mm}:${ss}</div>
                <div class="date-section">${yyyy}/${m}/${d} å‘¨${week}</div>
            `;
            requestAnimationFrame(updateClock);
        }
 
        // é‡‘å¥åŠŸèƒ½ 
		async function fetchGoldenPhrase() {
		    // 70%æ¦‚ç‡ä½¿ç”¨API
		    if (Math.random()  < apiProbability / 100) {
		        try {
		            const apiIndex = Math.floor(Math.random()  * GOLDEN_APIs.length); 
		            const api = GOLDEN_APIs[1];
		            const response = await fetch(api);
		            if (!response.ok)  throw new Error('ç½‘ç»œå¼‚å¸¸');
		            const data = await response.json(); 
		            let text = data.cn + "â€”â€”æ³°æˆˆå°”"; 
		            if (!text) {
		                throw new Error('æ•°æ®å¼‚å¸¸');
		            }
		            updatePhraseDisplay(text);
		        } catch (error) {
		            console.warn('  é‡‘å¥APIè·å–å¤±è´¥:', error);
		            showLocalPhrase();
		        }
		    } else {
		        // 30%æ¦‚ç‡ä½¿ç”¨æœ¬åœ°é‡‘å¥åº“
		        showLocalPhrase();
		    }
		}
 
        function updatePhraseDisplay(text) {
		    const container = document.getElementById('goldenPhrase'); 
		    container.style.opacity  = 0;
		    setTimeout(() => {
		        container.textContent  = `ã€Œ ${text} ã€`;
		        container.style.opacity  = 1;
		    }, 500);
		}
 
        function showLocalPhrase() {
            // åˆ›å»ºåŠ æƒé€‰æ‹©æ± 
            const weightedPool = [
                ...localPhrases.high.map(p => ({ p, w: 6 })),   // é«˜æ¦‚ç‡åŒºï¼šæƒé‡6
                ...localPhrases.medium.map(p => ({ p, w: 3 })), // ä¸­æ¦‚ç‡åŒºï¼šæƒé‡3 
                ...localPhrases.low.map(p => ({ p, w: 1 }))     // ä½æ¦‚ç‡åŒºï¼šæƒé‡1
            ];
		    // è®¡ç®—æ€»æƒé‡
            const totalWeight = weightedPool.reduce((sum, item) => sum + item.w, 0);
            // ç”Ÿæˆéšæœºé€‰æ‹©æ•°
            let random = Math.random() * totalWeight;
            // éå†é€‰æ‹©æ± å¯»æ‰¾å‘½ä¸­é¡¹
            for (const item of weightedPool) {
                if (random < item.w) {
                    return updatePhraseDisplay(item.p);
                }
                random -= item.w;
            }
		}

		function fetchAndDisplayImage(url) {
		    fetch('https://api.cenguigui.cn/api/60s/')
		        .then(response => response.blob()) 
		        .then(blob => {
		            const img = document.getElementById('apiImage'); 
		            img.src  = URL.createObjectURL(blob); 
		            img.style.height  = '80vh';
		        })
		        .catch(error => console.error(' å›¾ç‰‡åŠ è½½å¤±è´¥:', error));
		}

        // åˆå§‹åŒ–å¼€å…³çŠ¶æ€
        const goldenSwitch = document.getElementById('goldenSwitch'); 
        const imageSwitch = document.getElementById('imageSwitch'); 
        const apiImage = document.getElementById('apiImage'); 

        // é‡‘å¥è‡ªåŠ¨è½®æ’­å¼€å…³
        goldenSwitch.addEventListener('change', function() {
            if (this.checked) {
                phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
            } else {
                clearInterval(phraseTimer);
                phraseTimer = null;
            }
        });

        // æ˜¾ç¤ºæ¯æ—¥60så¼€å…³
        imageSwitch.addEventListener('change',  function() {
            if (this.checked)  {
                apiImage.style.display  = 'block';
                fetchAndDisplayImage();
                setInterval(fetchAndDisplayImage, 86400000);
            } else {
                apiImage.style.display  = 'none';
                clearInterval(imageUpdateInterval);
            }
        });

        // åˆå§‹åŒ–æ—¶è®¾ç½®é»˜è®¤çŠ¶æ€
        goldenSwitch.checked  = true; // é»˜è®¤å¼€å¯é‡‘å¥è‡ªåŠ¨è½®æ’­
        imageSwitch.checked  = true; // é»˜è®¤å¼€å¯æ¯æ—¥60sæ˜¾ç¤º

        function fetchWeather() {
            fetch('https://v2.api-m.com/api/weather?city=%E5%B2%B3%E9%BA%93%E5%8C%BA')
                .then(response => {
                    if (!response.ok) throw new Error('ç½‘ç»œå“åº”å¼‚å¸¸');
                    return response.json();
                })
                .then(data => {
                if (data.code === 200) {
                    // è·å–å½“å‰æ˜ŸæœŸï¼ˆç¤ºä¾‹è¿”å›æ ¼å¼ï¼š"å‘¨äº”"ï¼‰
                    const weekDays = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
                    const currentDay = 'å‘¨' + weekDays[new Date().getDay()];

                    // æŸ¥æ‰¾åŒ¹é…çš„å¤©æ°”æ•°æ®
                    const todayWeather = data.data.data.find(item => item.date === currentDay);

                    if (todayWeather) {
                        // æ ¼å¼åŒ–æ¸©åº¦æ˜¾ç¤ºï¼ˆ7-10â„ƒ â†’ 7~10â„ƒï¼‰
                        const tempRange = todayWeather.temperature.replace('-', '~');
                        document.getElementById('weatherInfo').textContent = 
                        `${todayWeather.weather} ${tempRange}`;
                    } else {
                        document.getElementById('weatherInfo').textContent = 'å¤©æ°”æ•°æ®å¼‚å¸¸';
                    }
                } else {
                    throw new Error(data.msg);
                }
                })
            .catch(error => {
                console.error('å¤©æ°”è·å–å¤±è´¥:', error);
                document.getElementById('weatherInfo').textContent = 'å¤©æ°”è·å–å¤±è´¥';
            });
        }

        window.onload  = function() {
            fetchAndDisplayImage();
        };
 
        // åˆå§‹åŒ– 
        function init() {
		    updateCountdown();
		    updateClock();
		    updateTimelineColor();
		    generateSolarMarkers();
		    fetchGoldenPhrase();
		    phraseTimer = setInterval(fetchGoldenPhrase, intervalDuration);
		    setInterval(updateScheduleDisplay, 1000);
            fetchWeather();
            setInterval(fetchWeather, 15000);
		}
 
        init();
		window.addEventListener('unload',  () => clearInterval(phraseTimer));
		setInterval(() => {
		    generateSolarMarkers();
		    updateCountdown();
		}, 86400000);
    </script>
</body>
</html>